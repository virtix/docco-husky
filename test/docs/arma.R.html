<!DOCTYPE html><html><head><title>arma.R</title><meta http-equiv="Content-Type" content="text/html" charset="UTF-8"><link rel="stylesheet" media="all" href="./docco.css"></head><body><div id="container"><div id="background"></div><div id="jump_to">Jump To &hellip;<div id="jump_wrapper"><div id="jump_page"><a href="./index.html" class="source"><span class="file_name">README</span></a><a href="././agents.clj.html" class="source "><span class="base_path">. / </span><span class="file_name">agents.clj</span></a><a href="././arma.R.html" class="source selected"><span class="base_path">. / </span><span class="file_name">arma.R</span></a><a href="././crypto_null.c.html" class="source "><span class="base_path">. / </span><span class="file_name">crypto_null.c</span></a><a href="././Foo.java.html" class="source "><span class="base_path">. / </span><span class="file_name">Foo.java</span></a><a href="././gen-ide-json.php.html" class="source "><span class="base_path">. / </span><span class="file_name">gen-ide-json.php</span></a><a href="././hello.bf.html" class="source "><span class="base_path">. / </span><span class="file_name">hello.bf</span></a><a href="././phantomjs.pp.html" class="source "><span class="base_path">. / </span><span class="file_name">phantomjs.pp</span></a><a href="././test.js.html" class="source "><span class="base_path">. / </span><span class="file_name">test.js</span></a><a href="././views.py.html" class="source "><span class="base_path">. / </span><span class="file_name">views.py</span></a></div></div></div><table cellpadding="0" cellspacing="0"><thead><tr><th class="docs"><h1>arma.R</h1><div class="filepath">./</div></th><th class="code"></th></tr></thead><tbody><tr id="section-1"><td class="docs"><div class="pilwrap"><a href="#section-1" class="pilcrow">&#182;</a></div><h2>R: ARMA modeling - estimation, diagnostics, forecasting.</h2>

<h3>0. SETUP DATA</h3>
</td><td class="code"><div class="highlight"><pre>rawdata <span class="o">&lt;-</span> c<span class="p">(</span><span class="m">-0.21</span><span class="p">,</span><span class="m">-2.28</span><span class="p">,</span><span class="m">-2.71</span><span class="p">,</span><span class="m">2.26</span><span class="p">,</span><span class="m">-1.11</span><span class="p">,</span><span class="m">1.71</span><span class="p">,</span><span class="m">2.63</span><span class="p">,</span><span class="m">-0.45</span><span class="p">,</span><span class="m">-0.11</span><span class="p">,</span><span class="m">4.79</span><span class="p">,</span><span class="m">5.07</span><span class="p">,</span><span class="m">-2.24</span><span class="p">,</span><span class="m">6.46</span><span class="p">,</span><span class="m">3.82</span><span class="p">,</span><span class="m">4.29</span><span class="p">,</span><span class="m">-1.47</span><span class="p">,</span><span class="m">2.69</span><span class="p">,</span>
             <span class="m">7.95</span><span class="p">,</span><span class="m">4.46</span><span class="p">,</span><span class="m">7.28</span><span class="p">,</span><span class="m">3.43</span><span class="p">,</span><span class="m">-3.19</span><span class="p">,</span><span class="m">-3.14</span><span class="p">,</span><span class="m">-1.25</span><span class="p">,</span><span class="m">-0.50</span><span class="p">,</span><span class="m">2.25</span><span class="p">,</span><span class="m">2.77</span><span class="p">,</span><span class="m">6.72</span><span class="p">,</span><span class="m">9.17</span><span class="p">,</span><span class="m">3.73</span><span class="p">,</span><span class="m">6.72</span><span class="p">,</span><span class="m">6.04</span><span class="p">,</span><span class="m">10.62</span><span class="p">,</span><span class="m">9.89</span><span class="p">,</span><span class="m">8.23</span><span class="p">,</span>
             <span class="m">5.37</span><span class="p">,</span><span class="m">-0.10</span><span class="p">,</span><span class="m">1.40</span><span class="p">,</span><span class="m">1.60</span><span class="p">,</span><span class="m">3.40</span><span class="p">,</span><span class="m">3.80</span><span class="p">,</span><span class="m">3.60</span><span class="p">,</span><span class="m">4.90</span><span class="p">,</span><span class="m">9.60</span><span class="p">,</span><span class="m">18.20</span><span class="p">,</span><span class="m">20.60</span><span class="p">,</span><span class="m">15.20</span><span class="p">,</span><span class="m">27.00</span><span class="p">,</span><span class="m">15.42</span><span class="p">,</span><span class="m">13.31</span><span class="p">,</span><span class="m">11.22</span><span class="p">,</span><span class="m">12.77</span><span class="p">,</span>
             <span class="m">12.43</span><span class="p">,</span><span class="m">15.83</span><span class="p">,</span><span class="m">11.44</span><span class="p">,</span><span class="m">12.32</span><span class="p">,</span><span class="m">12.10</span><span class="p">,</span><span class="m">12.02</span><span class="p">,</span><span class="m">14.41</span><span class="p">,</span><span class="m">13.54</span><span class="p">,</span><span class="m">11.36</span><span class="p">,</span><span class="m">12.97</span><span class="p">,</span><span class="m">10.00</span><span class="p">,</span><span class="m">7.20</span><span class="p">,</span><span class="m">8.74</span><span class="p">,</span><span class="m">3.92</span><span class="p">,</span><span class="m">8.73</span><span class="p">,</span><span class="m">2.19</span><span class="p">,</span><span class="m">3.85</span><span class="p">,</span>
             <span class="m">1.48</span><span class="p">,</span><span class="m">2.28</span><span class="p">,</span><span class="m">2.98</span><span class="p">,</span><span class="m">4.21</span><span class="p">,</span><span class="m">3.85</span><span class="p">,</span><span class="m">6.52</span><span class="p">,</span><span class="m">8.16</span><span class="p">,</span><span class="m">5.36</span><span class="p">,</span><span class="m">8.58</span><span class="p">,</span><span class="m">7.00</span><span class="p">,</span><span class="m">10.57</span><span class="p">,</span><span class="m">7.12</span><span class="p">,</span><span class="m">7.95</span><span class="p">,</span><span class="m">7.05</span><span class="p">,</span><span class="m">3.84</span><span class="p">,</span><span class="m">4.93</span><span class="p">,</span><span class="m">4.30</span><span class="p">,</span><span class="m">5.44</span><span class="p">,</span><span class="m">3.77</span><span class="p">,</span>
             <span class="m">4.71</span><span class="p">,</span><span class="m">3.18</span><span class="p">,</span><span class="m">0.00</span><span class="p">,</span><span class="m">5.25</span><span class="p">,</span><span class="m">4.27</span><span class="p">,</span><span class="m">5.14</span><span class="p">,</span><span class="m">3.53</span><span class="p">,</span><span class="m">4.54</span><span class="p">,</span><span class="m">4.70</span><span class="p">,</span><span class="m">7.40</span><span class="p">,</span><span class="m">4.80</span><span class="p">,</span><span class="m">6.20</span><span class="p">,</span><span class="m">7.29</span><span class="p">,</span><span class="m">7.30</span><span class="p">,</span><span class="m">8.38</span><span class="p">,</span><span class="m">3.83</span><span class="p">,</span><span class="m">8.07</span><span class="p">,</span><span class="m">4.88</span><span class="p">,</span><span class="m">8.17</span><span class="p">,</span><span class="m">8.25</span>
             <span class="p">,</span><span class="m">6.46</span><span class="p">,</span><span class="m">5.96</span><span class="p">,</span><span class="m">5.88</span><span class="p">,</span><span class="m">5.03</span><span class="p">,</span><span class="m">4.99</span><span class="p">,</span><span class="m">5.87</span><span class="p">,</span><span class="m">6.78</span><span class="p">,</span><span class="m">7.43</span><span class="p">,</span><span class="m">3.61</span><span class="p">,</span><span class="m">4.29</span><span class="p">,</span><span class="m">2.97</span><span class="p">,</span><span class="m">2.35</span><span class="p">,</span><span class="m">2.49</span><span class="p">,</span><span class="m">1.56</span><span class="p">,</span><span class="m">2.65</span><span class="p">,</span><span class="m">2.49</span><span class="p">,</span><span class="m">2.85</span><span class="p">,</span><span class="m">1.89</span><span class="p">,</span><span class="m">3.05</span><span class="p">,</span><span class="m">2.27</span><span class="p">,</span>
             <span class="m">2.91</span><span class="p">,</span><span class="m">3.94</span><span class="p">,</span><span class="m">2.34</span><span class="p">,</span><span class="m">3.14</span><span class="p">,</span><span class="m">4.11</span><span class="p">,</span><span class="m">4.12</span><span class="p">,</span><span class="m">4.53</span><span class="p">,</span><span class="m">7.11</span><span class="p">,</span><span class="m">6.17</span><span class="p">,</span><span class="m">6.25</span><span class="p">,</span><span class="m">7.03</span><span class="p">,</span><span class="m">4.13</span><span class="p">,</span><span class="m">6.15</span><span class="p">,</span><span class="m">6.73</span><span class="p">,</span><span class="m">6.99</span><span class="p">,</span><span class="m">5.86</span><span class="p">,</span><span class="m">4.19</span><span class="p">,</span><span class="m">6.38</span><span class="p">,</span><span class="m">6.68</span><span class="p">,</span><span class="m">6.58</span><span class="p">,</span>
             <span class="m">5.75</span><span class="p">,</span><span class="m">7.51</span><span class="p">,</span><span class="m">6.22</span><span class="p">,</span><span class="m">8.22</span><span class="p">,</span><span class="m">7.45</span><span class="p">,</span><span class="m">8.00</span><span class="p">,</span><span class="m">8.29</span><span class="p">,</span><span class="m">8.05</span><span class="p">,</span><span class="m">8.91</span><span class="p">,</span><span class="m">6.83</span><span class="p">,</span><span class="m">7.33</span><span class="p">,</span><span class="m">8.52</span><span class="p">,</span><span class="m">8.62</span><span class="p">,</span><span class="m">9.80</span><span class="p">,</span><span class="m">10.63</span><span class="p">,</span><span class="m">7.70</span><span class="p">,</span><span class="m">8.91</span><span class="p">,</span><span class="m">7.50</span><span class="p">,</span><span class="m">5.88</span><span class="p">,</span><span class="m">9.82</span><span class="p">,</span>
             <span class="m">8.44</span><span class="p">,</span><span class="m">10.92</span><span class="p">,</span><span class="m">11.67</span><span class="p">)</span></pre></div></td></tr><tr id="section-2"><td class="docs"><div class="pilwrap"><a href="#section-2" class="pilcrow">&#182;</a></div><p>Make a R timeseries out of the rawdata: specify frequency &amp; startdate</p>
</td><td class="code"><div class="highlight"><pre>gIIP <span class="o">&lt;-</span> ts<span class="p">(</span>rawdata<span class="p">,</span> frequency<span class="o">=</span><span class="m">12</span><span class="p">,</span> start<span class="o">=</span>c<span class="p">(</span><span class="m">1991</span><span class="p">,</span><span class="m">4</span><span class="p">))</span>
print<span class="p">(</span>gIIP<span class="p">)</span>
plot.ts<span class="p">(</span>gIIP<span class="p">,</span> type<span class="o">=</span><span class="s">&quot;l&quot;</span><span class="p">,</span> col<span class="o">=</span><span class="s">&quot;blue&quot;</span><span class="p">,</span> ylab<span class="o">=</span><span class="s">&quot;IIP Growth (%)&quot;</span><span class="p">,</span> lwd<span class="o">=</span><span class="m">2</span><span class="p">,</span>
        main<span class="o">=</span><span class="s">&quot;Full data&quot;</span><span class="p">)</span>
grid<span class="p">()</span></pre></div></td></tr><tr id="section-3"><td class="docs"><div class="pilwrap"><a href="#section-3" class="pilcrow">&#182;</a></div><p>Based on this, I decide that 4/1995 is the start of the sensible period.</p>
</td><td class="code"><div class="highlight"><pre>gIIP <span class="o">&lt;-</span> window<span class="p">(</span>gIIP<span class="p">,</span> start<span class="o">=</span>c<span class="p">(</span><span class="m">1995</span><span class="p">,</span><span class="m">4</span><span class="p">))</span>
print<span class="p">(</span>gIIP<span class="p">)</span>
plot.ts<span class="p">(</span>gIIP<span class="p">,</span> type<span class="o">=</span><span class="s">&quot;l&quot;</span><span class="p">,</span> col<span class="o">=</span><span class="s">&quot;blue&quot;</span><span class="p">,</span> ylab<span class="o">=</span><span class="s">&quot;IIP Growth (%)&quot;</span><span class="p">,</span> lwd<span class="o">=</span><span class="m">2</span><span class="p">,</span>
        main<span class="o">=</span><span class="s">&quot;Estimation subset&quot;</span><span class="p">)</span>
grid<span class="p">()</span></pre></div></td></tr><tr id="section-4"><td class="docs"><div class="pilwrap"><a href="#section-4" class="pilcrow">&#182;</a></div><p>Descriptive statistics about gIIP</p>
</td><td class="code"><div class="highlight"><pre>mean<span class="p">(</span>gIIP<span class="p">);</span> sd<span class="p">(</span>gIIP<span class="p">);</span> summary<span class="p">(</span>gIIP<span class="p">);</span>
plot<span class="p">(</span>density<span class="p">(</span>gIIP<span class="p">),</span> col<span class="o">=</span><span class="s">&quot;blue&quot;</span><span class="p">,</span> main<span class="o">=</span><span class="s">&quot;(Unconditional) Density of IIP growth&quot;</span><span class="p">)</span>
acf<span class="p">(</span>gIIP<span class="p">)</span></pre></div></td></tr><tr id="section-5"><td class="docs"><div class="pilwrap"><a href="#section-5" class="pilcrow">&#182;</a></div><h3>1. ARMA ESTIMATION</h3>
</td><td class="code"><div class="highlight"><pre>m.ar2 <span class="o">&lt;-</span> arima<span class="p">(</span>gIIP<span class="p">,</span> order <span class="o">=</span> c<span class="p">(</span><span class="m">2</span><span class="p">,</span><span class="m">0</span><span class="p">,</span><span class="m">0</span><span class="p">))</span>
print<span class="p">(</span>m.ar2<span class="p">)</span>                       <span class="c1"># Print it out</span></pre></div></td></tr><tr id="section-6"><td class="docs"><div class="pilwrap"><a href="#section-6" class="pilcrow">&#182;</a></div><h3>2. ARMA DIAGNOSTICS</h3>
</td><td class="code"><div class="highlight"><pre>tsdiag<span class="p">(</span>m.ar2<span class="p">)</span>                      <span class="c1"># His pretty picture of diagnostics</span></pre></div></td></tr><tr id="section-7"><td class="docs"><div class="pilwrap"><a href="#section-7" class="pilcrow">&#182;</a></div><p>Time series structure in errors</p>
</td><td class="code"><div class="highlight"><pre>print<span class="p">(</span>Box.test<span class="p">(</span>m.ar2<span class="o">$</span>residuals<span class="p">,</span> lag<span class="o">=</span><span class="m">12</span><span class="p">,</span> type<span class="o">=</span><span class="s">&quot;Ljung-Box&quot;</span><span class="p">));</span></pre></div></td></tr><tr id="section-8"><td class="docs"><div class="pilwrap"><a href="#section-8" class="pilcrow">&#182;</a></div><p>Sniff for ARCH</p>
</td><td class="code"><div class="highlight"><pre>print<span class="p">(</span>Box.test<span class="p">(</span>m.ar2<span class="o">$</span>residuals<span class="o">^</span><span class="m">2</span><span class="p">,</span> lag<span class="o">=</span><span class="m">12</span><span class="p">,</span> type<span class="o">=</span><span class="s">&quot;Ljung-Box&quot;</span><span class="p">));</span></pre></div></td></tr><tr id="section-9"><td class="docs"><div class="pilwrap"><a href="#section-9" class="pilcrow">&#182;</a></div><p>Eyeball distribution of residuals</p>
</td><td class="code"><div class="highlight"><pre>plot<span class="p">(</span>density<span class="p">(</span>m.ar2<span class="o">$</span>residuals<span class="p">),</span> col<span class="o">=</span><span class="s">&quot;blue&quot;</span><span class="p">,</span> xlim<span class="o">=</span>c<span class="p">(</span><span class="m">-8</span><span class="p">,</span><span class="m">8</span><span class="p">),</span>
     main<span class="o">=</span>paste<span class="p">(</span><span class="s">&quot;Residuals of AR(2)&quot;</span><span class="p">))</span></pre></div></td></tr><tr id="section-10"><td class="docs"><div class="pilwrap"><a href="#section-10" class="pilcrow">&#182;</a></div><h3>3. FORECASTING</h3>

<p>Make a picture of the residuals</p>
</td><td class="code"><div class="highlight"><pre>plot.ts<span class="p">(</span>m.ar2<span class="o">$</span>residual<span class="p">,</span> ylab<span class="o">=</span><span class="s">&quot;Innovations&quot;</span><span class="p">,</span> col<span class="o">=</span><span class="s">&quot;blue&quot;</span><span class="p">,</span> lwd<span class="o">=</span><span class="m">2</span><span class="p">)</span>
s <span class="o">&lt;-</span> sqrt<span class="p">(</span>m.ar2<span class="o">$</span>sigma2<span class="p">)</span>
abline<span class="p">(</span>h<span class="o">=</span>c<span class="p">(</span><span class="o">-</span>s<span class="p">,</span>s<span class="p">),</span> lwd<span class="o">=</span><span class="m">2</span><span class="p">,</span> col<span class="o">=</span><span class="s">&quot;lightGray&quot;</span><span class="p">)</span>

p <span class="o">&lt;-</span> predict<span class="p">(</span>m.ar2<span class="p">,</span> n.ahead <span class="o">=</span> <span class="m">12</span><span class="p">)</span>         <span class="c1"># Make 12 predictions.</span>
print<span class="p">(</span>p<span class="p">)</span></pre></div></td></tr><tr id="section-11"><td class="docs"><div class="pilwrap"><a href="#section-11" class="pilcrow">&#182;</a></div><p>Watch the forecastability decay away from fat values to 0.
sd(x) is the naive sigma. p$se is the prediction se.</p>
</td><td class="code"><div class="highlight"><pre>gain <span class="o">&lt;-</span> <span class="m">100</span><span class="o">*</span><span class="p">(</span><span class="m">1</span><span class="o">-</span>p<span class="o">$</span>se<span class="o">/</span>sd<span class="p">(</span>gIIP<span class="p">))</span>
plot.ts<span class="p">(</span>gain<span class="p">,</span> main<span class="o">=</span><span class="s">&quot;Gain in forecast s.d.&quot;</span><span class="p">,</span> ylab<span class="o">=</span><span class="s">&quot;Per cent&quot;</span><span class="p">,</span>
        col<span class="o">=</span><span class="s">&quot;blue&quot;</span><span class="p">,</span> lwd<span class="o">=</span><span class="m">2</span><span class="p">)</span></pre></div></td></tr><tr id="section-12"><td class="docs"><div class="pilwrap"><a href="#section-12" class="pilcrow">&#182;</a></div><p>Make a pretty picture that puts it all together</p>
</td><td class="code"><div class="highlight"><pre>ts.plot<span class="p">(</span>gIIP<span class="p">,</span> p<span class="o">$</span>pred<span class="p">,</span> p<span class="o">$</span>pred<span class="m">-1.96</span><span class="o">*</span>p<span class="o">$</span>se<span class="p">,</span> p<span class="o">$</span>pred<span class="m">+1.96</span><span class="o">*</span>p<span class="o">$</span>se<span class="p">,</span>
        gpars<span class="o">=</span>list<span class="p">(</span>lty<span class="o">=</span>c<span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="m">2</span><span class="p">),</span> lwd<span class="o">=</span>c<span class="p">(</span><span class="m">2</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="m">1</span><span class="p">),</span>
          ylab<span class="o">=</span><span class="s">&quot;IIP growth (%)&quot;</span><span class="p">,</span> col<span class="o">=</span>c<span class="p">(</span><span class="s">&quot;blue&quot;</span><span class="p">,</span><span class="s">&quot;red&quot;</span><span class="p">,</span> <span class="s">&quot;red&quot;</span><span class="p">,</span> <span class="s">&quot;red&quot;</span><span class="p">)))</span>
grid<span class="p">()</span>
abline<span class="p">(</span>h<span class="o">=</span>mean<span class="p">(</span>gIIP<span class="p">),</span> lty<span class="o">=</span><span class="m">2</span><span class="p">,</span> lwd<span class="o">=</span><span class="m">2</span><span class="p">,</span> col<span class="o">=</span><span class="s">&quot;lightGray&quot;</span><span class="p">)</span>
legend<span class="p">(</span>x<span class="o">=</span><span class="s">&quot;bottomleft&quot;</span><span class="p">,</span> cex<span class="o">=</span><span class="m">0.8</span><span class="p">,</span> bty<span class="o">=</span><span class="s">&quot;n&quot;</span><span class="p">,</span>
       lty<span class="o">=</span>c<span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="m">2</span><span class="p">),</span> lwd<span class="o">=</span>c<span class="p">(</span><span class="m">2</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="p">),</span>
       col<span class="o">=</span>c<span class="p">(</span><span class="s">&quot;blue&quot;</span><span class="p">,</span> <span class="s">&quot;red&quot;</span><span class="p">,</span> <span class="s">&quot;red&quot;</span><span class="p">,</span> <span class="s">&quot;lightGray&quot;</span><span class="p">),</span>
       legend<span class="o">=</span>c<span class="p">(</span><span class="s">&quot;IIP&quot;</span><span class="p">,</span> <span class="s">&quot;AR(2) forecasts&quot;</span><span class="p">,</span> <span class="s">&quot;95% C.I.&quot;</span><span class="p">,</span> <span class="s">&quot;Mean IIP growth&quot;</span><span class="p">))</span>

</pre></div></td></tr></tbody></table><div id="generated">generated Sun Feb 17 2013 20:30:03 GMT-0500 (EST)  </div></div></body></html>